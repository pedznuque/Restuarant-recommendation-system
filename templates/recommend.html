<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/static/recommend.css">


    <title>Restaurant Recommendation</title>

</head>
<body>
      <div class="sticky">
        <header>
          <div class="logo">
            <img src="https://www.linkpicture.com/q/linkedin_banner_image_1.png" alt="">
          </div>
          <nav>
            <ul>
              {% if 'username' in session %}
                <li><a href="{{ url_for('index') }}">HOME</a></li>
                <li class="dropdown">
                  <a href="#" onclick="toggleDropdown()">{{ session['username'] }}!</a>
                  <div class="dropdown-menu">
                    <a href="/profile">Profile settings</a>
                    <a href="/bookmarks">Bookmarks</a>
                    {% if session['is_admin'] %}
                      <a href="{{ url_for('user_list') }}">Admin</a>
                    {% endif %}
                  </div>
                </li>
                <li><a href="/logout">LOG OUT</a></li>
              {% else %}
              <li><a href="{{ url_for('index') }}">HOME</a></li>
              <li><a href="/login">LOG-IN</a></li>
              <li><a href="/register">SIGN-IN</a></li>
              {% endif %}
            </ul>
          </nav>
        </header>
  <div class="upper">

      <div class="rate_container">
              <div class="rate_style">
                <div class="rate_name">Min Rate &#9733</div> 
                <input type="range" id="rating-slider" min="1" max="4" value="1" step="1" onchange="filterRestaurants()">
              </div>
              <div class="sort_container">
                <button id="sort-button" onclick="sortRestaurants()">SORT A to Z &#8593&#8595</button>
              </div>
              <div class="price_container">
              <button id="price-sort-button" onclick="sortRestaurantsByPrice()">SORT BY PRICE &#8593&#8595</button>
              </div>
          </div>

     

  <div class="middle">

  

  </div>


        <div class="search_container">
          <div class="search_style">
            <form method="GET" action="{{ url_for('search') }}">
              <input type="text" name="query" placeholder="Search for a restaurant" id="query">
              <button type="submit"><img src="https://cdn-icons-png.flaticon.com/512/751/751463.png" alt=""></button>
            </form>
          </div>
      </div>
  
</div>

</div>

<div class="Main_container">
  <div class="margin_top"></div>
  <div class="container">


   
      
      
      <div class="restaurant-container">
        {% for restaurant in restaurants %}
        <div class="restaurant">
          <a href="{{ url_for('details', name=restaurant.Resto_id) }}"> 
            <div class="thumbnail"><img src="{{ restaurant.image_url }}" alt=""></div>
            <div class="resto_details">
              <div class="resto_name">{{ restaurant.Resto_name | truncate(25) }}</div>
              <div class="resto-info">
                <div class="rating">{{ restaurant.rating }} &#9733</div>
                <div class="location">{{ restaurant.location }}</div>
                <div class="cuisine">{{ restaurant.cuisine_type | truncate(29) }}</div>
                <div class="cost">Average cost for two: &#8369; {{ restaurant.cost_for_two }}</div>
              </div>
            </div>
          </a>
        </div>
        
        
        {% endfor %}
      </div>
    </div>
  </div>
</body>

<script>
        function filterRestaurants() {
          var slider = document.getElementById("rating-slider");
          var rating = slider.value;
          var restaurants = document.getElementsByClassName("restaurant");
          for (var i = 0; i < restaurants.length; i++) {
            var restaurant = restaurants[i];
            var restaurantRating = parseInt(restaurant.querySelector(".rating").innerHTML);
            if (restaurantRating < rating) {
              restaurant.style.display = "none";
            } else {
              restaurant.style.display = "block";
            }
          }
        }

        function sortRestaurants() {
  var restaurants = document.getElementsByClassName("restaurant");
  var restaurantArray = Array.prototype.slice.call(restaurants);
  restaurantArray.sort(function(a, b) {
    var nameA = a.querySelector(".resto_name").innerHTML.toUpperCase();
    var nameB = b.querySelector(".resto_name").innerHTML.toUpperCase();
    if (nameA < nameB) {
      return -1;
    }
    if (nameA > nameB) {
      return 1;
    }
    return 0;
  });
  var container = document.querySelector(".restaurant-container");
  container.innerHTML = "";
  for (var i = 0; i < restaurantArray.length; i++) {
    container.appendChild(restaurantArray[i]);
  }
}

function sortRestaurantsByPrice() {
  var restaurants = document.getElementsByClassName("restaurant");
  var restaurantArray = Array.prototype.slice.call(restaurants);
  restaurantArray.sort(function(a, b) {
    return a.querySelector(".cost").textContent.replace(/[^\d.-]/g, '') - b.querySelector(".cost").textContent.replace(/[^\d.-]/g, '');
  });
  var container = document.querySelector(".restaurant-container");
  container.innerHTML = "";
  for (var i = 0; i < restaurantArray.length; i++) {
    container.appendChild(restaurantArray[i]);
  }
}


function toggleDropdown() {
    var dropdown = document.querySelector('.dropdown-menu');
    dropdown.classList.toggle('show');
    dropdown.style.transition = "transform 0.2s ease-in-out, opacity 0.2s ease-in-out";
  }



</script>


</div>
</body>
</html>